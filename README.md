# âš ï¸ é£é™©é¡»çŸ¥


<a href="https://trackgit.com">
</a>


<div align="center">
  <p>
    <b>ä¸€æ¡å‘½ä»¤éƒ¨ç½² Kubernetes é«˜å¯ç”¨é›†ç¾¤ ğŸ‘‹</b>
  </p>
  <p>
     <i>ä»¥kubernetesä¸ºå†…æ ¸çš„äº‘æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆï¼Œè®©äº‘åŸç”Ÿç®€å•æ™®åŠã€‚ä¸€æ¡å‘½ä»¤é«˜å¯ç”¨å®‰è£…ä»»æ„ç‰ˆæœ¬kubernetesï¼Œæ”¯æŒç¦»çº¿ï¼ŒåŒ…å«æ‰€æœ‰ä¾èµ–ï¼Œå†…æ ¸è´Ÿè½½ä¸ä¾èµ–haproxy keepalived,çº¯golangå¼€å‘,99å¹´è¯ä¹¦</i>
  </p>
  <p>


  </p>
</div>

---


![](docs/images/arch.png)

# âœ¨ æ”¯æŒçš„ç¯å¢ƒ

## Linux å‘è¡Œç‰ˆ, CPUæ¶æ„

- Debian 9+,  x86_64/ arm64
- Ubuntu 16.04, 18.04, 20.04,  x86_64/ arm64
- Centos/RHEL 7.6+,  x86_64/ arm64
- å…¶ä»–æ”¯æŒ systemd çš„ç³»ç»Ÿç¯å¢ƒ,  x86_64/ arm64
- Kylin arm64

## kubernetes ç‰ˆæœ¬

- 1.16+
- 1.17+
- 1.18+
- 1.19+
- 1.20+
- 1.21+
- 1.22+
- 1.23+


## è¦æ±‚å’Œå»ºè®®

- æœ€ä½èµ„æºè¦æ±‚
   - 2 vCpu
   - 4G Ram
   - 40G+ å­˜å‚¨

- æ“ä½œç³»ç»Ÿè¦æ±‚
   - ssh å¯ä»¥è®¿é—®å„å®‰è£…èŠ‚ç‚¹
   - å„èŠ‚ç‚¹ä¸»æœºåä¸ç›¸åŒï¼Œå¹¶æ»¡è¶³kubernetesçš„ä¸»æœºåè¦æ±‚ã€‚
   - å„èŠ‚ç‚¹æ—¶é—´åŒæ­¥
   - ç½‘å¡åç§°å¦‚æœæ˜¯ä¸å¸¸è§çš„ï¼Œå»ºè®®ä¿®æ”¹æˆè§„èŒƒçš„ç½‘å¡åç§°ï¼Œ å¦‚(eth.*|en.*|em.*)
   - kubernetes1.20+ ä½¿ç”¨containerdä½œä¸ºcri. ä¸éœ€è¦ç”¨æˆ·å®‰è£…docker/containerd. trendyosä¼šå®‰è£…1.3.9ç‰ˆæœ¬containerdã€‚
   - kubernetes1.19åŠä»¥ä¸‹ ä½¿ç”¨dockerä½œä¸ºcriã€‚ ä¹Ÿä¸éœ€è¦ç”¨æˆ·å®‰è£…dockerã€‚ trendyosä¼šå®‰è£…1.19.03ç‰ˆæœ¬docker
 - ç½‘ç»œå’Œ DNS è¦æ±‚ï¼š
   - ç¡®ä¿ /etc/resolv.conf ä¸­çš„ DNS åœ°å€å¯ç”¨ã€‚å¦åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¾¤é›†ä¸­corednså¼‚å¸¸ã€‚
   - trendyos é»˜è®¤ä¼šå…³é—­é˜²ç«å¢™ï¼Œ å¦‚æœéœ€è¦æ‰“å¼€é˜²ç«å¢™ï¼Œ å»ºè®®æ‰‹åŠ¨æ”¾è¡Œç›¸å…³çš„ç«¯å£ã€‚
 - å†…æ ¸è¦æ±‚:
   - cniç»„ä»¶é€‰æ‹©ciliumæ—¶è¦æ±‚å†…æ ¸ç‰ˆæœ¬ä¸ä½äº5.4

# ğŸš€ å¿«é€Ÿå¼€å§‹

> ç¯å¢ƒä¿¡æ¯

ä¸»æœºå|IPåœ°å€
---|---
master0|192.168.0.2
master1|192.168.0.3
master2|192.168.0.4
node0|192.168.0.5

æœåŠ¡å™¨å¯†ç ï¼š123456

**kubernetes .0ç‰ˆæœ¬ä¸å»ºè®®ä¸Šç”Ÿäº§ç¯å¢ƒ!!!**

> åªéœ€è¦å‡†å¤‡å¥½æœåŠ¡å™¨ï¼Œåœ¨ä»»æ„ä¸€å°æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹é¢å‘½ä»¤å³å¯

```sh

# è·å–ç¦»çº¿èµ„æºåŒ…
$ kube1.19.12.tar.gz

# å®‰è£…ä¸€ä¸ªä¸‰masterçš„kubernetesé›†ç¾¤
$ trendyos init --passwd '123456' \
	--master 192.168.0.2  --master 192.168.0.3  --master 192.168.0.4  \
	--node 192.168.0.5 \
	--pkg-url /root/kube1.19.12.tar.gz \
	--version v1.19.12
# æ£€æŸ¥å®‰è£…æ˜¯å¦æˆåŠŸ
$ kubectl get node -owide
```

> å‚æ•°å«ä¹‰

å‚æ•°å|å«ä¹‰|ç¤ºä¾‹
---|---|---
passwd|æœåŠ¡å™¨å¯†ç |123456
master|k8s masterèŠ‚ç‚¹IPåœ°å€| 192.168.0.2
node|k8s nodeèŠ‚ç‚¹IPåœ°å€|192.168.0.3
pkg-url|ç¦»çº¿èµ„æºåŒ…åœ°å€ï¼Œæ”¯æŒä¸‹è½½åˆ°æœ¬åœ°ï¼Œæˆ–è€…ä¸€ä¸ªè¿œç¨‹åœ°å€|/root/kube1.22.0.tar.gz

> å¢åŠ master

```shell script
ğŸ³ â†’ trendyos join --master 192.168.0.6 --master 192.168.0.7
ğŸ³ â†’ trendyos join --master 192.168.0.6-192.168.0.9  # æˆ–è€…å¤šä¸ªè¿ç»­IP
```

> å¢åŠ node

```shell script
ğŸ³ â†’ trendyos join --node 192.168.0.6 --node 192.168.0.7
ğŸ³ â†’ trendyos join --node 192.168.0.6-192.168.0.9  # æˆ–è€…å¤šä¸ªè¿ç»­IP
```
> åˆ é™¤æŒ‡å®šmasterèŠ‚ç‚¹

```shell script
ğŸ³ â†’ trendyos clean --master 192.168.0.6 --master 192.168.0.7
ğŸ³ â†’ trendyos clean --master 192.168.0.6-192.168.0.9  # æˆ–è€…å¤šä¸ªè¿ç»­IP
```

> åˆ é™¤æŒ‡å®šnodeèŠ‚ç‚¹

```shell script
ğŸ³ â†’ trendyos clean --node 192.168.0.6 --node 192.168.0.7
ğŸ³ â†’ trendyos clean --node 192.168.0.6-192.168.0.9  # æˆ–è€…å¤šä¸ªè¿ç»­IP
```

> æ¸…ç†é›†ç¾¤

```shell script
ğŸ³ â†’ trendyos clean --all
```

# âœ… ç‰¹æ€§

- [x] æ”¯æŒARMç‰ˆæœ¬ç¦»çº¿åŒ…ï¼Œv1.20ç‰ˆæœ¬ç¦»çº¿åŒ…æ”¯æŒcontainerdé›†æˆï¼Œå®Œå…¨æŠ›å¼ƒdocker
- [x] 99å¹´è¯ä¹¦, æ”¯æŒé›†ç¾¤å¤‡ä»½ï¼Œå‡çº§
- [x] ä¸ä¾èµ–ansible haproxy keepalived, ä¸€ä¸ªäºŒè¿›åˆ¶å·¥å…·ï¼Œ0ä¾èµ–
- [x] é«˜å¯ç”¨é€šè¿‡ipvså®ç°çš„localLBï¼Œå ç”¨èµ„æºå°‘ï¼Œç¨³å®šå¯é ï¼Œç±»ä¼¼kube-proxyçš„å®ç°
- [x] å‡ ä¹å¯å…¼å®¹æ‰€æœ‰æ”¯æŒsystemdçš„x86_64æ¶æ„çš„ç¯å¢ƒ
- [x] è½»æ¾å®ç°é›†ç¾¤èŠ‚ç‚¹çš„å¢åŠ /åˆ é™¤
- [x] èµ„æºåŒ…æ”¾åœ¨é˜¿é‡Œäº‘ossä¸Šï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒç½‘é€Ÿ
- [x] dashboard ingress prometheusç­‰APP åŒæ ·ç¦»çº¿æ‰“åŒ…ï¼Œä¸€é”®å®‰è£…
- [x] æ”¯æŒé›†ç¾¤é•œåƒï¼Œè‡ªç”±ç»„åˆå®šåˆ¶ä½ éœ€è¦çš„é›†ç¾¤ï¼Œå¦‚openebså­˜å‚¨+æ•°æ®åº“+minioå¯¹è±¡å­˜å‚¨

# ğŸ“Š Stats

## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=zhuhuahua168/trendyos&type=Date)](https://star-history.com/#zhuhuahua168/trendyos&Date)
